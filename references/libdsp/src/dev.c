/****************************************************************************
*
* $Source: /cvs/c30_dsp/src/dev.c,v $
* $Revision: 1.1.1.1 $
*
* Copyright 2002, Microchip, Inc.  All rights reserved.
*
* Main controller to develop DSP Libary operations.
*
* $Log: dev.c,v $
* Revision 1.1.1.1  2003/06/20 22:22:54  wilkiec
* DSP library, src and verified build
*
****************************************************************************/

/* Global headers. */
#include <stdio.h>		/* printf */
#include <stdlib.h>		/* malloc, NULL, RAND_MAX */

/*...........................................................................*/

/* Local headers. */
#include "dsp.h"				/* DSP Library interface */
#include "testing.h"				/* testing interface */

#define	NUM_ROWS		3		/* rows in test matrix */
#define	NUM_COLS		2		/* columns in test matrix */
#define	LOG2N			4		/* 2^LOG2N elements into FFT */
#define	NUM_FACTS		(1<<(LOG2N-1))	/* factors for transforms */
#define	NUM_ELEMS		16		/* elements in test vector */
#if	DATA_TYPE==FLOATING		/* [ */
#define	SCL_VALUE		0.03125		/* a scaling value */
#else	/* ][ */
#define	SCL_VALUE		0x0400		/* a scaling value */
#endif	/* ] */
#define	RATE			3		/* decim/interp ratio */
#define	NUM_TAPS		4*RATE		/* taps in decim/interp filt */
#define	NUM_SAMPS		6*NUM_TAPS	/* samples to filter */
#define	NUM_SECTS		4		/* sections in an IIR[C,T] */
#define	LATT_ORDER		3		/* lattice filter order */
#define	SQRT_2_OVER_NUM_TAPS	0.4082		/* for FIRLMSNorm */

#define Buf_X __attribute__((__section__(".xbss")))
#define Buf_Y __attribute__((__section__(".ybss")))
#define Buf_P __attribute__((__section__(".const, x")))
#define ModBuf_X(k) __attribute__((__section__(".xbss"), aligned(k)))
#define ModBuf_Y(k) __attribute__((__section__(".ybss"), aligned(k)))
#define ModBuf_P(k) __attribute__((__section__(".const, x"), aligned(k)))


/* Local variables. */
fractional VectorOne[NUM_ELEMS] Buf_X = {
#if	DATA_TYPE==FLOATING		/* [ */
   0.07105749438466,
  -0.45072200340399,
   0.20085723323733,
   0.46228825871716,
   0.25051823194427,
   0.23999304537847,
  -0.06812661439303,
   0.13426595631548,
   0.30302634023193,
  -0.41611899299897,
   0.44546278791039,
   0.41594245989412,
   0.10198742363800,
  -0.24643942126767,
   0.37345080554039,
   0.01340070999628
#else	/* ][ */
  0x0918,
  0xC64F,
  0x19B6,
  0x3B2C,
  0x2011,
  0x1EB8,
  0xF748,
  0x1130,
  0x26CA,
  0xCABD,
  0x3905,
  0x353E,
  0x0D0E,
  0xE075,
  0x2FCD,
  0x01B7
#endif	/* ] */
};

fractional VectorTwo[NUM_ELEMS] Buf_Y = {
#if	DATA_TYPE==FLOATING		/* [ */
   -.5000000000000,
   -.0312500000000,
   -.0019531250000,
   -.0001220703125,
   -.0019531250000,
   -.0312500000000,
   -.5000000000000,
   -.0312500000000,
   -.0019531250000,
   -.0001220703125,
   -.0019531250000,
   -.0312500000000,
   -.5000000000000,
   -.0312500000000,
   -.0019531250000,
   -.0001220703125
#else	/* ][ */
   0xC000,
   0xFC00,
   0xFFC0,
   0xFFFC,
   0xFFC0,
   0xFC00,
   0xC000,
   0xFC00,
   0xFFC0,
   0xFFFC,
   0xFFC0,
   0xFC00,
   0xC000,
   0xFC00,
   0xFFC0,
   0xFFFC
#endif	/* ] */
};

fractional SrcSamps[NUM_SAMPS] = {
#if	DATA_TYPE==FLOATING		/* [ */
   0.50000000000000,
   0.95331466100000,
   0.70701201330000,
   0.01785227478000,
  -0.29285774600000,
   0.03736504679000,
   0.36426779120000,
   0.04389262615000,
  -0.66041856210000,
  -0.92601269210000,
  -0.49441541310000,
  -0.01888715496000,
  -0.15659180780000,
  -0.66041856210000,
  -0.72552825810000,
  -0.11126046700000,
   0.51289330490000,
   0.47656313830000,
   0.01785227478000,
  -0.06240887099000,
   0.47778640290000,
   0.97552825810000,
   0.77167902900000,
   0.11922676100000,
  -0.16378335720000,
   0.18267051220000,
   0.51289330490000,
   0.18263215920000,
  -0.54389262610000,
  -0.84205419410000,
  -0.45048443400000,
  -0.01888715496000,
  -0.20052278700000,
  -0.74437706010000,
  -0.84205419410000,
  -0.25000000000000,
   0.36426779120000,
   0.33125767290000,
  -0.11122211400000,
  -0.16378335720000,
   0.41311938720000,
   0.95331466100000,
   0.79389262610000,
   0.18389377670000,
  -0.06240887099000,
   0.31174490090000,
   0.65819877030000,
   0.33125767290000,
  -0.40515309310000,
  -0.72552825810000,
  -0.36652593590000,
   0.02504382420000,
  -0.20052278700000,
  -0.78830803930000,
  -0.92601269210000,
  -0.36652593590000,
   0.22552825810000,
   0.18263215920000,
  -0.25652757940000,
  -0.29285774600000,
   0.31174490090000,
   0.88864764530000,
   0.77167902900000,
   0.20610737390000,
   0.00225814474500,
   0.41311938720000,
   0.78727315910000,
   0.47656313830000,
  -0.25652757940000,
  -0.58678872510000,
  -0.25000000000000,
   0.10900232220000
#else	/* ][ */
   0x4000,
   0x7A06,
   0x5A7F,
   0x0249,
   0xDA84,
   0x04C8,
   0x2EA0,
   0x059E,
   0xAB77,
   0x8978,
   0xC0B7,
   0xFD95,
   0xEBF5,
   0xAB77,
   0xA322,
   0xF1C2,
   0x41A6,
   0x3D00,
   0x0249,
   0xF803,
   0x3D28,
   0x7CDE,
   0x62C6,
   0x0F43,
   0xEB09,
   0x1762,
   0x41A6,
   0x1760,
   0xBA62,
   0x9438,
   0xC657,
   0xFD95,
   0xE655,
   0xA0B8,
   0x9438,
   0xE000,
   0x2EA0,
   0x2A67,
   0xF1C3,
   0xEB09,
   0x34E1,
   0x7A06,
   0x659E,
   0x178A,
   0xF803,
   0x27E7,
   0x5440,
   0x2A67,
   0xCC24,
   0xA322,
   0xD116,
   0x0335,
   0xE655,
   0x9B19,
   0x8978,
   0xD116,
   0x1CDE,
   0x1760,
   0xDF2A,
   0xDA84,
   0x27E7,
   0x71BF,
   0x62C6,
   0x1A62,
   0x004A,
   0x34E1,
   0x64C5,
   0x3D00,
   0xDF2A,
   0xB4E4,
   0xE000,
   0x0DF4
#endif	/* ] */
};

#ifdef	IN_SPACE			/* [ */
#if	IN_SPACE==IN_X_SPACE		/* [ X-Data memory space */
fractional FIRCoeffs[NUM_TAPS] Buf_X = {
#else	/* ][ */
fractional FIRCoeffs[NUM_TAPS] Buf_P = {
#endif	/* ] */
#else	/* ][ */
fractional FIRCoeffs[NUM_TAPS] = {
#endif	/* ] */
#if	DATA_TYPE==FLOATING		/* [ */
  -0.00287053740200,
   0.00000014397842,
   0.03463367775000,
  -0.07468350738000,
   0.00000058283692,
   0.54331825910000,
   0.54331825910000,
   0.00000058283692,
  -0.07468350738000,
   0.03463367775000,
   0.00000014397842,
  -0.00287053740200
#else	/* ][ */
   0xFFA2,
   0x0000,
   0x046F,
   0xF671,
   0x0000,
   0x458B,
   0x458B,
   0x0000,
   0xF671,
   0x046F,
   0x0000,
   0xFFA2
#endif	/* ] */
};

#ifdef	IN_SPACE			/* [ */
#if	IN_SPACE==IN_X_SPACE		/* [ X-Data memory space */
fractional IIRCanonicCoeffs[NUM_SECTS*5] Buf_X = {
#else	/* ][ */
fractional IIRCanonicCoeffs[NUM_SECTS*5] Buf_P = {
#endif	/* ] */
#else	/* ][ */
fractional IIRCanonicCoeffs[NUM_SECTS*5] = {
#endif	/* ] */
#if	DATA_TYPE==FLOATING		/* [ */
  -0.163513183593750,
   0.478363037109375,
   0.080505371093750,
   0.066406250000000,
   0.080505371093750,
  -0.288208007812500,
   0.513397216796875,
   0.080139160156250,
  -0.017456054687500,
   0.080139160156250,
  -0.426300048828125,
   0.567901611328125,
   0.528167724609375,
  -0.306335449218750,
   0.528167724609375,
   0.000000000000000,
   0.232421875000000,
   0.000000000000000,
   0.271545410156250,
   0.271545410156250
#else	/* ][ */
   0xEB10,
   0x3D3B,
   0x0A4E,
   0x0880,
   0x0A4E,
   0xDB1C,
   0x41B7,
   0x0A42,
   0xFDC4,
   0x0A42,
   0xC96F,
   0x48B1,
   0x439B,
   0xD8CA,
   0x439B,
   0x0000,
   0x1DC0,
   0x0000,
   0x22C2,
   0x22C2
#endif	/* ] */
};

#ifdef	IN_SPACE			/* [ */
#if	IN_SPACE==IN_X_SPACE		/* [ X-Data memory space */
fractional IIRTransposedCoeffs[NUM_SECTS*5] Buf_X = {
#else	/* ][ */
fractional IIRTransposedCoeffs[NUM_SECTS*5] Buf_P = {
#endif	/* ] */
#else	/* ][ */
fractional IIRTransposedCoeffs[NUM_SECTS*5] = {
#endif	/* ] */
#if	DATA_TYPE==FLOATING		/* [ */
   0.131042480468750,
   0.108093261718750,
   0.956726074218750,
   0.131042480468750,
  -0.000061035156250,
   0.299621582031250,
  -0.000061035156250,
  -0.973205566406250,
   0.299621582031250,
  -0.000061035156250,
   0.333496093750000,
  -0.000061035156250,
  -0.864196777343750,
   0.333496093750000,
  -0.000061035156250,
   0.416870117187500,
   0.416870117187500,
   0.464843750000000,
   0.000000000000000,
   0.000000000000000
#else	/* ][ */
	0x0863,
	0x06EB,
	0x3D3B,
	0x0863,
	0xEB12,
	0x132D,
	0xFBD2,
	0x41B7,
	0x132D,
	0xDB1C,
	0x1558,
	0xF39F,
	0x48B1,
	0x1558,
	0xC96F,
	0x1AAE,
	0x1AAE,
	0x1DC0,
	0x0000,
	0x0000
#endif	/* ] */
};

fractional FIRDelay[NUM_TAPS+1] Buf_Y;

#ifdef	IN_SPACE			/* [ */
#if	IN_SPACE==IN_X_SPACE		/* [ X-Data memory space */
fractional LattKappas[LATT_ORDER] Buf_X = {
#else	/* ][ */
fractional LattKappas[LATT_ORDER] Buf_P = {
#endif	/* ] */
#else	/* ][ */
fractional LattKappas[LATT_ORDER] = {
#endif	/* ] */
#if LATT_ORDER==8			/* [ */
#if	DATA_TYPE==FLOATING		/* [ */
   2.764336069078e-015
   9.740905761719e-001
   1.187526639523e-015
   9.813537597656e-001
  -2.894331909559e-015
   9.593200683594e-001
  -1.715804148067e-015
   6.891174316406e-001
   0.000000000000e+000
#else	/* ][ */
0000,
7CAF,
0000,
7D9D,
0000,
7ACB,
0000,
5835,
0000
#endif	/* ] */
#elif LATT_ORDER==6			/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
 -.82849121E+00,
 0.91232300E+00,
 -.85768127E+00,
 0.75523376E+00,
 -.46373749E+00,
 0.11520004E+00 
#else	/* ][ */
  0x95F4,
  0x74C7,
  0x9238,
  0x60AB,
  0xC4A4,
  0x0EBF
#endif	/* ] */
#else	/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
 0.67275747E+00,
 -.18197491E+00,
 0.57600000E+00
#else	/* ][ */
  0x561D,
  0xE8B5,
  0x49BA
#endif	/* ] */
#endif	/* ] */
};

fractional LattGammas[LATT_ORDER+1] = {
#if LATT_ORDER==8			/* [ */
#if	DATA_TYPE==FLOATING		/* [ */
   2.586781978607e-003
   2.429078734489e-017
  -5.023002624512e-003
  -9.230118026230e-017
   1.125168800354e-002
   2.544232863668e-017
  -7.516384124756e-003
  -5.446818897539e-019
   4.906058311462e-003
#else	/* ][ */
0055,
0000,
FF5B,
0000,
0171,
0000,
FF0A,
0000,
00A1
#endif	/* ] */
#elif LATT_ORDER==6			/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
 0.32936335E-02,
 0.45545578E-01,
 0.90078354E-01,
 0.84781647E-01,
 0.44531822E-01,
 0.14084101E-01,
 0.24024248E-02
#else	/* ][ */
0x006C,
  0x05D4,
  0x0B88,
  0x0ADA,
  0x05B3,
  0x01CE,
  0x004F
#endif	/* ] */
#endif	/* ] */
};

fractional LattDelay[LATT_ORDER] Buf_Y;

fractional theWindow[NUM_ELEMS];

fractional MatrixOne[NUM_ROWS*NUM_COLS] = {
#if	DATA_TYPE==FLOATING		/* [ */
   0.25, 0.625,
   0.0009765625, 0.0234375,
   0.5, 0.000152587890625
#else	/* ][ */
   0x2000, 0x5000,
   0x0020, 0x0300,
   0x4000, 0x0005
#endif	/* ] */
};

fractional MatrixTwo[NUM_ROWS*NUM_COLS] = {
#if	DATA_TYPE==FLOATING		/* [ */
 0.62500000E+00,-0.25000000E+00,
 0.84781647E-01, 0.44531822E-01,
 0.14084101E-01, 0.24024248E-02
#else	/* ][ */
   0x5000, 0xE000,
   0x0ADA, 0x05B3,
   0x01CE, 0x004F
#endif	/* ] */
};

#define	NUM_ROWSF	7		/* no greater than 7!!! */
#define	NUM_COLSF	NUM_ROWSF
float MatrixThree[NUM_ROWSF*NUM_COLSF] = {
  -0.24917602540000,
   0.18782043460000,
  -0.06300354004000,
   0.12306213380000,
   0.17205810550000,
   0.22958374020000,
   0.11509704590000,
   0.01930236816000,
   0.16918945310000,
   0.24804687500000,
  -0.17196655270000,
   0.18214416500000,
  -0.04350280762000,
   0.01666259766000,
  -0.24349975590000,
  -0.18428039550000,
  -0.06745910645000,
   0.05680847168000,
  -0.06460571289000,
  -0.23121643070000,
  -0.05900573730000,
  -0.08227539063000,
   0.22596740720000,
   0.18046569820000,
   0.14575195310000,
   0.11390686040000,
  -0.18359375000000,
   0.04118347168000,
   0.16079711910000,
  -0.20222473140000,
   0.01628112793000,
  -0.12840271000000,
  -0.17433166500000,
  -0.00418090820300,
  -0.13932800290000,
  -0.02699279785000,
  -0.23287963870000,
  -0.01368713379000,
  -0.21058654790000,
  -0.04806518555000,
   0.13735961910000,
   0.14682006840000,
  -0.08285522461000,
  -0.02745056152000,
   0.16984558110000,
  -0.15052795410000,
   0.15985107420000,
  -0.06056213379000,
  -0.05703735352000
};

#ifdef	IN_SPACE			/* [ */
#if	IN_SPACE==IN_X_SPACE		/* [ X-Data memory space */
fractcomplex TwidFactors[NUM_FACTS] ModBuf_X(NUM_FACTS*2) = {
#else	/* ][ program memory space */
fractcomplex TwidFactors[NUM_FACTS] ModBuf_P(NUM_FACTS*2) = {
#endif	/* ] */
#else	/* ][ */
fractcomplex TwidFactors[NUM_FACTS] = {
#endif	/* ] */
#if LOG2N==9				/* [ */
#if	DATA_TYPE==FLOATING		/* [ */
  { 1.00000000000000000000,  0.99992471933364868164},
  { 0.99969881772994995117,  0.99932235479354858398},
  { 0.99879544973373413086,  0.99811810255050659180},
  { 0.99729043245315551758,  0.99631261825561523438},
  { 0.99518471956253051758,  0.99390697479248046875},
  { 0.99247956275939941406,  0.99090266227722167969},
  { 0.98917651176452636719,  0.98730140924453735352},
  { 0.98527765274047851562,  0.98310548067092895508},
  { 0.98078525066375732422,  0.97831737995147705078},
  { 0.97570210695266723633,  0.97293996810913085938},
  { 0.97003126144409179688,  0.96697646379470825195},
  { 0.96377605199813842773,  0.96043050289154052734},
  { 0.95694035291671752930,  0.95330601930618286133},
  { 0.94952815771102905273,  0.94560730457305908203},
  { 0.94154405593872070312,  0.93733900785446166992},
  { 0.93299281597137451172,  0.92850607633590698242},
  { 0.92387950420379638672,  0.91911387443542480469},
  { 0.91420978307723999023,  0.90916800498962402344},
  { 0.90398931503295898438,  0.89867448806762695312},
  { 0.89322429895401000977,  0.88763964176177978516},
  { 0.88192129135131835938,  0.87607008218765258789},
  { 0.87008696794509887695,  0.86397284269332885742},
  { 0.85772860050201416016,  0.85135519504547119141},
  { 0.84485357999801635742,  0.83822470903396606445},
  { 0.83146959543228149414,  0.82458931207656860352},
  { 0.81758481264114379883,  0.81045717000961303711},
  { 0.80320751667022705078,  0.79583692550659179688},
  { 0.78834640979766845703,  0.78073722124099731445},
  { 0.77301043272018432617,  0.76516723632812500000},
  { 0.75720882415771484375,  0.74913638830184936523},
  { 0.74095112085342407227,  0.73265427350997924805},
  { 0.72424709796905517578,  0.71573084592819213867},
  { 0.70710676908493041992,  0.69837623834609985352},
  { 0.68954056501388549805,  0.68060100078582763672},
  { 0.67155897617340087891,  0.66241580247879028320},
  { 0.65317285060882568359,  0.64383155107498168945},
  { 0.63439327478408813477,  0.62485951185226440430},
  { 0.61523157358169555664,  0.60551106929779052734},
  { 0.59569931030273437500,  0.58579784631729125977},
  { 0.57580816745758056641,  0.56573182344436645508},
  { 0.55557024478912353516,  0.54532498121261596680},
  { 0.53499764204025268555,  0.52458965778350830078},
  { 0.51410275697708129883,  0.50353837013244628906},
  { 0.49289819598197937012,  0.48218378424644470215},
  { 0.47139674425125122070,  0.46053871512413024902},
  { 0.44961133599281311035,  0.43861624598503112793},
  { 0.42755508422851562500,  0.41642954945564270020},
  { 0.40524131059646606445,  0.39399203658103942871},
  { 0.38268342614173889160,  0.37131720781326293945},
  { 0.35989505052566528320,  0.34841868281364440918},
  { 0.33688986301422119141,  0.32531028985977172852},
  { 0.31368175148963928223,  0.30200594663619995117},
  { 0.29028466343879699707,  0.27851969003677368164},
  { 0.26671275496482849121,  0.25486564636230468750},
  { 0.24298018217086791992,  0.23105810582637786865},
  { 0.21910123527050018311,  0.20711137354373931885},
  { 0.19509032368659973145,  0.18303988873958587646},
  { 0.17096188664436340332,  0.15885815024375915527},
  { 0.14673046767711639404,  0.13458070158958435059},
  { 0.12241067737340927124,  0.11022220551967620850},
  { 0.09801714122295379639,  0.08579730987548828125},
  { 0.07356456667184829712,  0.06132073700428009033},
  { 0.04906767606735229492,  0.03680722415447235107},
  { 0.02454122900962829590,  0.01227153837680816650},
  {-0.00000000000000003447, -0.01227153837680816650},
  {-0.02454122900962829590, -0.03680722415447235107},
  {-0.04906767606735229492, -0.06132073700428009033},
  {-0.07356456667184829712, -0.08579730987548828125},
  {-0.09801714122295379639, -0.11022220551967620850},
  {-0.12241067737340927124, -0.13458070158958435059},
  {-0.14673046767711639404, -0.15885815024375915527},
  {-0.17096188664436340332, -0.18303988873958587646},
  {-0.19509032368659973145, -0.20711137354373931885},
  {-0.21910123527050018311, -0.23105810582637786865},
  {-0.24298018217086791992, -0.25486564636230468750},
  {-0.26671275496482849121, -0.27851969003677368164},
  {-0.29028466343879699707, -0.30200594663619995117},
  {-0.31368175148963928223, -0.32531028985977172852},
  {-0.33688986301422119141, -0.34841868281364440918},
  {-0.35989505052566528320, -0.37131720781326293945},
  {-0.38268342614173889160, -0.39399203658103942871},
  {-0.40524131059646606445, -0.41642954945564270020},
  {-0.42755508422851562500, -0.43861624598503112793},
  {-0.44961133599281311035, -0.46053871512413024902},
  {-0.47139674425125122070, -0.48218378424644470215},
  {-0.49289819598197937012, -0.50353837013244628906},
  {-0.51410275697708129883, -0.52458965778350830078},
  {-0.53499764204025268555, -0.54532498121261596680},
  {-0.55557024478912353516, -0.56573182344436645508},
  {-0.57580816745758056641, -0.58579784631729125977},
  {-0.59569931030273437500, -0.60551106929779052734},
  {-0.61523157358169555664, -0.62485951185226440430},
  {-0.63439327478408813477, -0.64383155107498168945},
  {-0.65317285060882568359, -0.66241580247879028320},
  {-0.67155897617340087891, -0.68060100078582763672},
  {-0.68954056501388549805, -0.69837623834609985352},
  {-0.70710676908493041992, -0.71573084592819213867},
  {-0.72424709796905517578, -0.73265427350997924805},
  {-0.74095112085342407227, -0.74913638830184936523},
  {-0.75720882415771484375, -0.76516723632812500000},
  {-0.77301043272018432617, -0.78073722124099731445},
  {-0.78834640979766845703, -0.79583692550659179688},
  {-0.80320751667022705078, -0.81045717000961303711},
  {-0.81758481264114379883, -0.82458931207656860352},
  {-0.83146959543228149414, -0.83822470903396606445},
  {-0.84485357999801635742, -0.85135519504547119141},
  {-0.85772860050201416016, -0.86397284269332885742},
  {-0.87008696794509887695, -0.87607008218765258789},
  {-0.88192129135131835938, -0.88763964176177978516},
  {-0.89322429895401000977, -0.89867448806762695312},
  {-0.90398931503295898438, -0.90916800498962402344},
  {-0.91420978307723999023, -0.91911387443542480469},
  {-0.92387950420379638672, -0.92850607633590698242},
  {-0.93299281597137451172, -0.93733900785446166992},
  {-0.94154405593872070312, -0.94560730457305908203},
  {-0.94952815771102905273, -0.95330601930618286133},
  {-0.95694035291671752930, -0.96043050289154052734},
  {-0.96377605199813842773, -0.96697646379470825195},
  {-0.97003126144409179688, -0.97293996810913085938},
  {-0.97570210695266723633, -0.97831737995147705078},
  {-0.98078525066375732422, -0.98310548067092895508},
  {-0.98527765274047851562, -0.98730140924453735352},
  {-0.98917651176452636719, -0.99090266227722167969},
  {-0.99247956275939941406, -0.99390697479248046875},
  {-0.99518471956253051758, -0.99631261825561523438},
  {-0.99729043245315551758, -0.99811810255050659180},
  {-0.99879544973373413086, -0.99932235479354858398},
  {-0.99969881772994995117, -0.99992471933364868164},
  { 0.00000000000000000000, -0.01227153837680816650},
  {-0.02454122900962829590, -0.03680722415447235107},
  {-0.04906767606735229492, -0.06132073700428009033},
  {-0.07356456667184829712, -0.08579730987548828125},
  {-0.09801714122295379639, -0.11022220551967620850},
  {-0.12241067737340927124, -0.13458070158958435059},
  {-0.14673046767711639404, -0.15885815024375915527},
  {-0.17096188664436340332, -0.18303988873958587646},
  {-0.19509032368659973145, -0.20711137354373931885},
  {-0.21910123527050018311, -0.23105810582637786865},
  {-0.24298018217086791992, -0.25486564636230468750},
  {-0.26671275496482849121, -0.27851969003677368164},
  {-0.29028466343879699707, -0.30200594663619995117},
  {-0.31368175148963928223, -0.32531028985977172852},
  {-0.33688986301422119141, -0.34841868281364440918},
  {-0.35989505052566528320, -0.37131720781326293945},
  {-0.38268342614173889160, -0.39399203658103942871},
  {-0.40524131059646606445, -0.41642954945564270020},
  {-0.42755508422851562500, -0.43861624598503112793},
  {-0.44961133599281311035, -0.46053871512413024902},
  {-0.47139674425125122070, -0.48218378424644470215},
  {-0.49289819598197937012, -0.50353837013244628906},
  {-0.51410275697708129883, -0.52458965778350830078},
  {-0.53499764204025268555, -0.54532498121261596680},
  {-0.55557024478912353516, -0.56573182344436645508},
  {-0.57580816745758056641, -0.58579784631729125977},
  {-0.59569931030273437500, -0.60551106929779052734},
  {-0.61523157358169555664, -0.62485951185226440430},
  {-0.63439327478408813477, -0.64383155107498168945},
  {-0.65317285060882568359, -0.66241580247879028320},
  {-0.67155897617340087891, -0.68060100078582763672},
  {-0.68954056501388549805, -0.69837623834609985352},
  {-0.70710676908493041992, -0.71573084592819213867},
  {-0.72424709796905517578, -0.73265427350997924805},
  {-0.74095112085342407227, -0.74913638830184936523},
  {-0.75720882415771484375, -0.76516723632812500000},
  {-0.77301043272018432617, -0.78073722124099731445},
  {-0.78834640979766845703, -0.79583692550659179688},
  {-0.80320751667022705078, -0.81045717000961303711},
  {-0.81758481264114379883, -0.82458931207656860352},
  {-0.83146959543228149414, -0.83822470903396606445},
  {-0.84485357999801635742, -0.85135519504547119141},
  {-0.85772860050201416016, -0.86397284269332885742},
  {-0.87008696794509887695, -0.87607008218765258789},
  {-0.88192129135131835938, -0.88763964176177978516},
  {-0.89322429895401000977, -0.89867448806762695312},
  {-0.90398931503295898438, -0.90916800498962402344},
  {-0.91420978307723999023, -0.91911387443542480469},
  {-0.92387950420379638672, -0.92850607633590698242},
  {-0.93299281597137451172, -0.93733900785446166992},
  {-0.94154405593872070312, -0.94560730457305908203},
  {-0.94952815771102905273, -0.95330601930618286133},
  {-0.95694035291671752930, -0.96043050289154052734},
  {-0.96377605199813842773, -0.96697646379470825195},
  {-0.97003126144409179688, -0.97293996810913085938},
  {-0.97570210695266723633, -0.97831737995147705078},
  {-0.98078525066375732422, -0.98310548067092895508},
  {-0.98527765274047851562, -0.98730140924453735352},
  {-0.98917651176452636719, -0.99090266227722167969},
  {-0.99247956275939941406, -0.99390697479248046875},
  {-0.99518471956253051758, -0.99631261825561523438},
  {-0.99729043245315551758, -0.99811810255050659180},
  {-0.99879544973373413086, -0.99932235479354858398},
  {-0.99969881772994995117, -0.99992471933364868164},
  {-1.00000000000000000000, -0.99992471933364868164},
  {-0.99969881772994995117, -0.99932235479354858398},
  {-0.99879544973373413086, -0.99811810255050659180},
  {-0.99729043245315551758, -0.99631261825561523438},
  {-0.99518471956253051758, -0.99390697479248046875},
  {-0.99247956275939941406, -0.99090266227722167969},
  {-0.98917651176452636719, -0.98730140924453735352},
  {-0.98527765274047851562, -0.98310548067092895508},
  {-0.98078525066375732422, -0.97831737995147705078},
  {-0.97570210695266723633, -0.97293996810913085938},
  {-0.97003126144409179688, -0.96697646379470825195},
  {-0.96377605199813842773, -0.96043050289154052734},
  {-0.95694035291671752930, -0.95330601930618286133},
  {-0.94952815771102905273, -0.94560730457305908203},
  {-0.94154405593872070312, -0.93733900785446166992},
  {-0.93299281597137451172, -0.92850607633590698242},
  {-0.92387950420379638672, -0.91911387443542480469},
  {-0.91420978307723999023, -0.90916800498962402344},
  {-0.90398931503295898438, -0.89867448806762695312},
  {-0.89322429895401000977, -0.88763964176177978516},
  {-0.88192129135131835938, -0.87607008218765258789},
  {-0.87008696794509887695, -0.86397284269332885742},
  {-0.85772860050201416016, -0.85135519504547119141},
  {-0.84485357999801635742, -0.83822470903396606445},
  {-0.83146959543228149414, -0.82458931207656860352},
  {-0.81758481264114379883, -0.81045717000961303711},
  {-0.80320751667022705078, -0.79583692550659179688},
  {-0.78834640979766845703, -0.78073722124099731445},
  {-0.77301043272018432617, -0.76516723632812500000},
  {-0.75720882415771484375, -0.74913638830184936523},
  {-0.74095112085342407227, -0.73265427350997924805},
  {-0.72424709796905517578, -0.71573084592819213867},
  {-0.70710676908493041992, -0.69837623834609985352},
  {-0.68954056501388549805, -0.68060100078582763672},
  {-0.67155897617340087891, -0.66241580247879028320},
  {-0.65317285060882568359, -0.64383155107498168945},
  {-0.63439327478408813477, -0.62485951185226440430},
  {-0.61523157358169555664, -0.60551106929779052734},
  {-0.59569931030273437500, -0.58579784631729125977},
  {-0.57580816745758056641, -0.56573182344436645508},
  {-0.55557024478912353516, -0.54532498121261596680},
  {-0.53499764204025268555, -0.52458965778350830078},
  {-0.51410275697708129883, -0.50353837013244628906},
  {-0.49289819598197937012, -0.48218378424644470215},
  {-0.47139674425125122070, -0.46053871512413024902},
  {-0.44961133599281311035, -0.43861624598503112793},
  {-0.42755508422851562500, -0.41642954945564270020},
  {-0.40524131059646606445, -0.39399203658103942871},
  {-0.38268342614173889160, -0.37131720781326293945},
  {-0.35989505052566528320, -0.34841868281364440918},
  {-0.33688986301422119141, -0.32531028985977172852},
  {-0.31368175148963928223, -0.30200594663619995117},
  {-0.29028466343879699707, -0.27851969003677368164},
  {-0.26671275496482849121, -0.25486564636230468750},
  {-0.24298018217086791992, -0.23105810582637786865},
  {-0.21910123527050018311, -0.20711137354373931885},
  {-0.19509032368659973145, -0.18303988873958587646},
  {-0.17096188664436340332, -0.15885815024375915527},
  {-0.14673046767711639404, -0.13458070158958435059},
  {-0.12241067737340927124, -0.11022220551967620850},
  {-0.09801714122295379639, -0.08579730987548828125},
  {-0.07356456667184829712, -0.06132073700428009033},
  {-0.04906767606735229492, -0.03680722415447235107},
  {-0.02454122900962829590, -0.01227153837680816650}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7FFE, 0xFE6E},
   {0x7FF6, 0xFCDC},
   {0x7FEA, 0xFB4A},
   {0x7FD9, 0xF9B8},
   {0x7FC2, 0xF827},
   {0x7FA7, 0xF695},
   {0x7F87, 0xF505},
   {0x7F62, 0xF374},
   {0x7F38, 0xF1E4},
   {0x7F0A, 0xF055},
   {0x7ED6, 0xEEC6},
   {0x7E9D, 0xED38},
   {0x7E60, 0xEBAB},
   {0x7E1E, 0xEA1E},
   {0x7DD6, 0xE892},
   {0x7D8A, 0xE707},
   {0x7D3A, 0xE57D},
   {0x7CE4, 0xE3F4},
   {0x7C89, 0xE26D},
   {0x7C2A, 0xE0E6},
   {0x7BC6, 0xDF61},
   {0x7B5D, 0xDDDC},
   {0x7AEF, 0xDC59},
   {0x7A7D, 0xDAD8},
   {0x7A06, 0xD958},
   {0x798A, 0xD7D9},
   {0x790A, 0xD65C},
   {0x7885, 0xD4E1},
   {0x77FB, 0xD367},
   {0x776C, 0xD1EF},
   {0x76D9, 0xD079},
   {0x7642, 0xCF04},
   {0x75A6, 0xCD92},
   {0x7505, 0xCC21},
   {0x7460, 0xCAB2},
   {0x73B6, 0xC946},
   {0x7308, 0xC7DB},
   {0x7255, 0xC673},
   {0x719E, 0xC50D},
   {0x70E3, 0xC3A9},
   {0x7023, 0xC248},
   {0x6F5F, 0xC0E9},
   {0x6E97, 0xBF8C},
   {0x6DCA, 0xBE32},
   {0x6CF9, 0xBCDA},
   {0x6C24, 0xBB85},
   {0x6B4B, 0xBA33},
   {0x6A6E, 0xB8E3},
   {0x698C, 0xB796},
   {0x68A7, 0xB64C},
   {0x67BD, 0xB505},
   {0x66D0, 0xB3C0},
   {0x65DE, 0xB27F},
   {0x64E9, 0xB140},
   {0x63EF, 0xB005},
   {0x62F2, 0xAECC},
   {0x61F1, 0xAD97},
   {0x60EC, 0xAC65},
   {0x5FE4, 0xAB36},
   {0x5ED7, 0xAA0A},
   {0x5DC8, 0xA8E2},
   {0x5CB4, 0xA7BD},
   {0x5B9D, 0xA69C},
   {0x5A82, 0xA57E},
   {0x5964, 0xA463},
   {0x5843, 0xA34C},
   {0x571E, 0xA238},
   {0x55F6, 0xA129},
   {0x54CA, 0xA01C},
   {0x539B, 0x9F14},
   {0x5269, 0x9E0F},
   {0x5134, 0x9D0E},
   {0x4FFB, 0x9C11},
   {0x4EC0, 0x9B17},
   {0x4D81, 0x9A22},
   {0x4C40, 0x9930},
   {0x4AFB, 0x9843},
   {0x49B4, 0x9759},
   {0x486A, 0x9674},
   {0x471D, 0x9592},
   {0x45CD, 0x94B5},
   {0x447B, 0x93DC},
   {0x4326, 0x9307},
   {0x41CE, 0x9236},
   {0x4074, 0x9169},
   {0x3F17, 0x90A1},
   {0x3DB8, 0x8FDD},
   {0x3C57, 0x8F1D},
   {0x3AF3, 0x8E62},
   {0x398D, 0x8DAB},
   {0x3825, 0x8CF8},
   {0x36BA, 0x8C4A},
   {0x354E, 0x8BA0},
   {0x33DF, 0x8AFB},
   {0x326E, 0x8A5A},
   {0x30FC, 0x89BE},
   {0x2F87, 0x8927},
   {0x2E11, 0x8894},
   {0x2C99, 0x8805},
   {0x2B1F, 0x877B},
   {0x29A4, 0x86F6},
   {0x2827, 0x8676},
   {0x26A8, 0x85FA},
   {0x2528, 0x8583},
   {0x23A7, 0x8511},
   {0x2224, 0x84A3},
   {0x209F, 0x843A},
   {0x1F1A, 0x83D6},
   {0x1D93, 0x8377},
   {0x1C0C, 0x831C},
   {0x1A83, 0x82C6},
   {0x18F9, 0x8276},
   {0x176E, 0x822A},
   {0x15E2, 0x81E2},
   {0x1455, 0x81A0},
   {0x12C8, 0x8163},
   {0x113A, 0x812A},
   {0x0FAB, 0x80F6},
   {0x0E1C, 0x80C8},
   {0x0C8C, 0x809E},
   {0x0AFB, 0x8079},
   {0x096B, 0x8059},
   {0x07D9, 0x803E},
   {0x0648, 0x8027},
   {0x04B6, 0x8016},
   {0x0324, 0x800A},
   {0x0192, 0x8002},
   {0x0000, 0x8000},
   {0xFE6E, 0x8002},
   {0xFCDC, 0x800A},
   {0xFB4A, 0x8016},
   {0xF9B8, 0x8027},
   {0xF827, 0x803E},
   {0xF695, 0x8059},
   {0xF505, 0x8079},
   {0xF374, 0x809E},
   {0xF1E4, 0x80C8},
   {0xF055, 0x80F6},
   {0xEEC6, 0x812A},
   {0xED38, 0x8163},
   {0xEBAB, 0x81A0},
   {0xEA1E, 0x81E2},
   {0xE892, 0x822A},
   {0xE707, 0x8276},
   {0xE57D, 0x82C6},
   {0xE3F4, 0x831C},
   {0xE26D, 0x8377},
   {0xE0E6, 0x83D6},
   {0xDF61, 0x843A},
   {0xDDDC, 0x84A3},
   {0xDC59, 0x8511},
   {0xDAD8, 0x8583},
   {0xD958, 0x85FA},
   {0xD7D9, 0x8676},
   {0xD65C, 0x86F6},
   {0xD4E1, 0x877B},
   {0xD367, 0x8805},
   {0xD1EF, 0x8894},
   {0xD079, 0x8927},
   {0xCF04, 0x89BE},
   {0xCD92, 0x8A5A},
   {0xCC21, 0x8AFB},
   {0xCAB2, 0x8BA0},
   {0xC946, 0x8C4A},
   {0xC7DB, 0x8CF8},
   {0xC673, 0x8DAB},
   {0xC50D, 0x8E62},
   {0xC3A9, 0x8F1D},
   {0xC248, 0x8FDD},
   {0xC0E9, 0x90A1},
   {0xBF8C, 0x9169},
   {0xBE32, 0x9236},
   {0xBCDA, 0x9307},
   {0xBB85, 0x93DC},
   {0xBA33, 0x94B5},
   {0xB8E3, 0x9592},
   {0xB796, 0x9674},
   {0xB64C, 0x9759},
   {0xB505, 0x9843},
   {0xB3C0, 0x9930},
   {0xB27F, 0x9A22},
   {0xB140, 0x9B17},
   {0xB005, 0x9C11},
   {0xAECC, 0x9D0E},
   {0xAD97, 0x9E0F},
   {0xAC65, 0x9F14},
   {0xAB36, 0xA01C},
   {0xAA0A, 0xA129},
   {0xA8E2, 0xA238},
   {0xA7BD, 0xA34C},
   {0xA69C, 0xA463},
   {0xA57E, 0xA57E},
   {0xA463, 0xA69C},
   {0xA34C, 0xA7BD},
   {0xA238, 0xA8E2},
   {0xA129, 0xAA0A},
   {0xA01C, 0xAB36},
   {0x9F14, 0xAC65},
   {0x9E0F, 0xAD97},
   {0x9D0E, 0xAECC},
   {0x9C11, 0xB005},
   {0x9B17, 0xB140},
   {0x9A22, 0xB27F},
   {0x9930, 0xB3C0},
   {0x9843, 0xB505},
   {0x9759, 0xB64C},
   {0x9674, 0xB796},
   {0x9592, 0xB8E3},
   {0x94B5, 0xBA33},
   {0x93DC, 0xBB85},
   {0x9307, 0xBCDA},
   {0x9236, 0xBE32},
   {0x9169, 0xBF8C},
   {0x90A1, 0xC0E9},
   {0x8FDD, 0xC248},
   {0x8F1D, 0xC3A9},
   {0x8E62, 0xC50D},
   {0x8DAB, 0xC673},
   {0x8CF8, 0xC7DB},
   {0x8C4A, 0xC946},
   {0x8BA0, 0xCAB2},
   {0x8AFB, 0xCC21},
   {0x8A5A, 0xCD92},
   {0x89BE, 0xCF04},
   {0x8927, 0xD079},
   {0x8894, 0xD1EF},
   {0x8805, 0xD367},
   {0x877B, 0xD4E1},
   {0x86F6, 0xD65C},
   {0x8676, 0xD7D9},
   {0x85FA, 0xD958},
   {0x8583, 0xDAD8},
   {0x8511, 0xDC59},
   {0x84A3, 0xDDDC},
   {0x843A, 0xDF61},
   {0x83D6, 0xE0E6},
   {0x8377, 0xE26D},
   {0x831C, 0xE3F4},
   {0x82C6, 0xE57D},
   {0x8276, 0xE707},
   {0x822A, 0xE892},
   {0x81E2, 0xEA1E},
   {0x81A0, 0xEBAB},
   {0x8163, 0xED38},
   {0x812A, 0xEEC6},
   {0x80F6, 0xF055},
   {0x80C8, 0xF1E4},
   {0x809E, 0xF374},
   {0x8079, 0xF505},
   {0x8059, 0xF695},
   {0x803E, 0xF827},
   {0x8027, 0xF9B8},
   {0x8016, 0xFB4A},
   {0x800A, 0xFCDC},
   {0x8002, 0xFE6E}
#endif	/* ] */
#elif LOG2N==8				/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
  { 1.00000000000000000000,  0.99969881772994995117},
  { 0.99879544973373413086,  0.99729043245315551758},
  { 0.99518471956253051758,  0.99247956275939941406},
  { 0.98917651176452636719,  0.98527765274047851562},
  { 0.98078525066375732422,  0.97570210695266723633},
  { 0.97003126144409179688,  0.96377605199813842773},
  { 0.95694035291671752930,  0.94952815771102905273},
  { 0.94154405593872070312,  0.93299281597137451172},
  { 0.92387950420379638672,  0.91420978307723999023},
  { 0.90398931503295898438,  0.89322429895401000977},
  { 0.88192129135131835938,  0.87008696794509887695},
  { 0.85772860050201416016,  0.84485357999801635742},
  { 0.83146959543228149414,  0.81758481264114379883},
  { 0.80320751667022705078,  0.78834640979766845703},
  { 0.77301043272018432617,  0.75720882415771484375},
  { 0.74095112085342407227,  0.72424709796905517578},
  { 0.70710676908493041992,  0.68954056501388549805},
  { 0.67155897617340087891,  0.65317285060882568359},
  { 0.63439327478408813477,  0.61523157358169555664},
  { 0.59569931030273437500,  0.57580816745758056641},
  { 0.55557024478912353516,  0.53499764204025268555},
  { 0.51410275697708129883,  0.49289819598197937012},
  { 0.47139674425125122070,  0.44961133599281311035},
  { 0.42755508422851562500,  0.40524131059646606445},
  { 0.38268342614173889160,  0.35989505052566528320},
  { 0.33688986301422119141,  0.31368175148963928223},
  { 0.29028466343879699707,  0.26671275496482849121},
  { 0.24298018217086791992,  0.21910123527050018311},
  { 0.19509032368659973145,  0.17096188664436340332},
  { 0.14673046767711639404,  0.12241067737340927124},
  { 0.09801714122295379639,  0.07356456667184829712},
  { 0.04906767606735229492,  0.02454122900962829590},
  {-0.00000000000000002972, -0.02454122900962829590},
  {-0.04906767606735229492, -0.07356456667184829712},
  {-0.09801714122295379639, -0.12241067737340927124},
  {-0.14673046767711639404, -0.17096188664436340332},
  {-0.19509032368659973145, -0.21910123527050018311},
  {-0.24298018217086791992, -0.26671275496482849121},
  {-0.29028466343879699707, -0.31368175148963928223},
  {-0.33688986301422119141, -0.35989505052566528320},
  {-0.38268342614173889160, -0.40524131059646606445},
  {-0.42755508422851562500, -0.44961133599281311035},
  {-0.47139674425125122070, -0.49289819598197937012},
  {-0.51410275697708129883, -0.53499764204025268555},
  {-0.55557024478912353516, -0.57580816745758056641},
  {-0.59569931030273437500, -0.61523157358169555664},
  {-0.63439327478408813477, -0.65317285060882568359},
  {-0.67155897617340087891, -0.68954056501388549805},
  {-0.70710676908493041992, -0.72424709796905517578},
  {-0.74095112085342407227, -0.75720882415771484375},
  {-0.77301043272018432617, -0.78834640979766845703},
  {-0.80320751667022705078, -0.81758481264114379883},
  {-0.83146959543228149414, -0.84485357999801635742},
  {-0.85772860050201416016, -0.87008696794509887695},
  {-0.88192129135131835938, -0.89322429895401000977},
  {-0.90398931503295898438, -0.91420978307723999023},
  {-0.92387950420379638672, -0.93299281597137451172},
  {-0.94154405593872070312, -0.94952815771102905273},
  {-0.95694035291671752930, -0.96377605199813842773},
  {-0.97003126144409179688, -0.97570210695266723633},
  {-0.98078525066375732422, -0.98527765274047851562},
  {-0.98917651176452636719, -0.99247956275939941406},
  {-0.99518471956253051758, -0.99729043245315551758},
  {-0.99879544973373413086, -0.99969881772994995117},
  { 0.00000000000000000000, -0.02454122900962829590},
  {-0.04906767606735229492, -0.07356456667184829712},
  {-0.09801714122295379639, -0.12241067737340927124},
  {-0.14673046767711639404, -0.17096188664436340332},
  {-0.19509032368659973145, -0.21910123527050018311},
  {-0.24298018217086791992, -0.26671275496482849121},
  {-0.29028466343879699707, -0.31368175148963928223},
  {-0.33688986301422119141, -0.35989505052566528320},
  {-0.38268342614173889160, -0.40524131059646606445},
  {-0.42755508422851562500, -0.44961133599281311035},
  {-0.47139674425125122070, -0.49289819598197937012},
  {-0.51410275697708129883, -0.53499764204025268555},
  {-0.55557024478912353516, -0.57580816745758056641},
  {-0.59569931030273437500, -0.61523157358169555664},
  {-0.63439327478408813477, -0.65317285060882568359},
  {-0.67155897617340087891, -0.68954056501388549805},
  {-0.70710676908493041992, -0.72424709796905517578},
  {-0.74095112085342407227, -0.75720882415771484375},
  {-0.77301043272018432617, -0.78834640979766845703},
  {-0.80320751667022705078, -0.81758481264114379883},
  {-0.83146959543228149414, -0.84485357999801635742},
  {-0.85772860050201416016, -0.87008696794509887695},
  {-0.88192129135131835938, -0.89322429895401000977},
  {-0.90398931503295898438, -0.91420978307723999023},
  {-0.92387950420379638672, -0.93299281597137451172},
  {-0.94154405593872070312, -0.94952815771102905273},
  {-0.95694035291671752930, -0.96377605199813842773},
  {-0.97003126144409179688, -0.97570210695266723633},
  {-0.98078525066375732422, -0.98527765274047851562},
  {-0.98917651176452636719, -0.99247956275939941406},
  {-0.99518471956253051758, -0.99729043245315551758},
  {-0.99879544973373413086, -0.99969881772994995117},
  {-1.00000000000000000000, -0.99969881772994995117},
  {-0.99879544973373413086, -0.99729043245315551758},
  {-0.99518471956253051758, -0.99247956275939941406},
  {-0.98917651176452636719, -0.98527765274047851562},
  {-0.98078525066375732422, -0.97570210695266723633},
  {-0.97003126144409179688, -0.96377605199813842773},
  {-0.95694035291671752930, -0.94952815771102905273},
  {-0.94154405593872070312, -0.93299281597137451172},
  {-0.92387950420379638672, -0.91420978307723999023},
  {-0.90398931503295898438, -0.89322429895401000977},
  {-0.88192129135131835938, -0.87008696794509887695},
  {-0.85772860050201416016, -0.84485357999801635742},
  {-0.83146959543228149414, -0.81758481264114379883},
  {-0.80320751667022705078, -0.78834640979766845703},
  {-0.77301043272018432617, -0.75720882415771484375},
  {-0.74095112085342407227, -0.72424709796905517578},
  {-0.70710676908493041992, -0.68954056501388549805},
  {-0.67155897617340087891, -0.65317285060882568359},
  {-0.63439327478408813477, -0.61523157358169555664},
  {-0.59569931030273437500, -0.57580816745758056641},
  {-0.55557024478912353516, -0.53499764204025268555},
  {-0.51410275697708129883, -0.49289819598197937012},
  {-0.47139674425125122070, -0.44961133599281311035},
  {-0.42755508422851562500, -0.40524131059646606445},
  {-0.38268342614173889160, -0.35989505052566528320},
  {-0.33688986301422119141, -0.31368175148963928223},
  {-0.29028466343879699707, -0.26671275496482849121},
  {-0.24298018217086791992, -0.21910123527050018311},
  {-0.19509032368659973145, -0.17096188664436340332},
  {-0.14673046767711639404, -0.12241067737340927124},
  {-0.09801714122295379639, -0.07356456667184829712},
  {-0.04906767606735229492, -0.02454122900962829590}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7FF6, 0xFCDC},
   {0x7FD9, 0xF9B8},
   {0x7FA7, 0xF695},
   {0x7F62, 0xF374},
   {0x7F0A, 0xF055},
   {0x7E9D, 0xED38},
   {0x7E1E, 0xEA1E},
   {0x7D8A, 0xE707},
   {0x7CE4, 0xE3F4},
   {0x7C2A, 0xE0E6},
   {0x7B5D, 0xDDDC},
   {0x7A7D, 0xDAD8},
   {0x798A, 0xD7D9},
   {0x7885, 0xD4E1},
   {0x776C, 0xD1EF},
   {0x7642, 0xCF04},
   {0x7505, 0xCC21},
   {0x73B6, 0xC946},
   {0x7255, 0xC673},
   {0x70E3, 0xC3A9},
   {0x6F5F, 0xC0E9},
   {0x6DCA, 0xBE32},
   {0x6C24, 0xBB85},
   {0x6A6E, 0xB8E3},
   {0x68A7, 0xB64C},
   {0x66D0, 0xB3C0},
   {0x64E9, 0xB140},
   {0x62F2, 0xAECC},
   {0x60EC, 0xAC65},
   {0x5ED7, 0xAA0A},
   {0x5CB4, 0xA7BD},
   {0x5A82, 0xA57E},
   {0x5843, 0xA34C},
   {0x55F6, 0xA129},
   {0x539B, 0x9F14},
   {0x5134, 0x9D0E},
   {0x4EC0, 0x9B17},
   {0x4C40, 0x9930},
   {0x49B4, 0x9759},
   {0x471D, 0x9592},
   {0x447B, 0x93DC},
   {0x41CE, 0x9236},
   {0x3F17, 0x90A1},
   {0x3C57, 0x8F1D},
   {0x398D, 0x8DAB},
   {0x36BA, 0x8C4A},
   {0x33DF, 0x8AFB},
   {0x30FC, 0x89BE},
   {0x2E11, 0x8894},
   {0x2B1F, 0x877B},
   {0x2827, 0x8676},
   {0x2528, 0x8583},
   {0x2224, 0x84A3},
   {0x1F1A, 0x83D6},
   {0x1C0C, 0x831C},
   {0x18F9, 0x8276},
   {0x15E2, 0x81E2},
   {0x12C8, 0x8163},
   {0x0FAB, 0x80F6},
   {0x0C8C, 0x809E},
   {0x096B, 0x8059},
   {0x0648, 0x8027},
   {0x0324, 0x800A},
   {0x0000, 0x8000},
   {0xFCDC, 0x800A},
   {0xF9B8, 0x8027},
   {0xF695, 0x8059},
   {0xF374, 0x809E},
   {0xF055, 0x80F6},
   {0xED38, 0x8163},
   {0xEA1E, 0x81E2},
   {0xE707, 0x8276},
   {0xE3F4, 0x831C},
   {0xE0E6, 0x83D6},
   {0xDDDC, 0x84A3},
   {0xDAD8, 0x8583},
   {0xD7D9, 0x8676},
   {0xD4E1, 0x877B},
   {0xD1EF, 0x8894},
   {0xCF04, 0x89BE},
   {0xCC21, 0x8AFB},
   {0xC946, 0x8C4A},
   {0xC673, 0x8DAB},
   {0xC3A9, 0x8F1D},
   {0xC0E9, 0x90A1},
   {0xBE32, 0x9236},
   {0xBB85, 0x93DC},
   {0xB8E3, 0x9592},
   {0xB64C, 0x9759},
   {0xB3C0, 0x9930},
   {0xB140, 0x9B17},
   {0xAECC, 0x9D0E},
   {0xAC65, 0x9F14},
   {0xAA0A, 0xA129},
   {0xA7BD, 0xA34C},
   {0xA57E, 0xA57E},
   {0xA34C, 0xA7BD},
   {0xA129, 0xAA0A},
   {0x9F14, 0xAC65},
   {0x9D0E, 0xAECC},
   {0x9B17, 0xB140},
   {0x9930, 0xB3C0},
   {0x9759, 0xB64C},
   {0x9592, 0xB8E3},
   {0x93DC, 0xBB85},
   {0x9236, 0xBE32},
   {0x90A1, 0xC0E9},
   {0x8F1D, 0xC3A9},
   {0x8DAB, 0xC673},
   {0x8C4A, 0xC946},
   {0x8AFB, 0xCC21},
   {0x89BE, 0xCF04},
   {0x8894, 0xD1EF},
   {0x877B, 0xD4E1},
   {0x8676, 0xD7D9},
   {0x8583, 0xDAD8},
   {0x84A3, 0xDDDC},
   {0x83D6, 0xE0E6},
   {0x831C, 0xE3F4},
   {0x8276, 0xE707},
   {0x81E2, 0xEA1E},
   {0x8163, 0xED38},
   {0x80F6, 0xF055},
   {0x809E, 0xF374},
   {0x8059, 0xF695},
   {0x8027, 0xF9B8},
   {0x800A, 0xFCDC}
#endif	/* ] */
#elif LOG2N==7				/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
  { 1.000000000000000, -0.000000000000000},
  { 0.998795449733734, -0.049067676067352},
  { 0.995184719562531, -0.098017141222954},
  { 0.989176511764526, -0.146730467677116},
  { 0.980785250663757, -0.195090323686600},
  { 0.970031261444092, -0.242980182170868},
  { 0.956940352916718, -0.290284663438797},
  { 0.941544055938721, -0.336889863014221},
  { 0.923879504203796, -0.382683426141739},
  { 0.903989315032959, -0.427555084228516},
  { 0.881921291351318, -0.471396744251251},
  { 0.857728600502014, -0.514102756977081},
  { 0.831469595432281, -0.555570244789124},
  { 0.803207516670227, -0.595699310302734},
  { 0.773010432720184, -0.634393274784088},
  { 0.740951120853424, -0.671558976173401},
  { 0.707106769084930, -0.707106769084930},
  { 0.671558976173401, -0.740951120853424},
  { 0.634393274784088, -0.773010432720184},
  { 0.595699310302734, -0.803207516670227},
  { 0.555570244789124, -0.831469595432281},
  { 0.514102756977081, -0.857728600502014},
  { 0.471396744251251, -0.881921291351318},
  { 0.427555084228516, -0.903989315032959},
  { 0.382683426141739, -0.923879504203796},
  { 0.336889863014221, -0.941544055938721},
  { 0.290284663438797, -0.956940352916718},
  { 0.242980182170868, -0.970031261444092},
  { 0.195090323686600, -0.980785250663757},
  { 0.146730467677116, -0.989176511764526},
  { 0.098017141222954, -0.995184719562531},
  { 0.049067676067352, -0.998795449733734},
  { 0.000000000000000, -1.000000000000000},
  {-0.0490676760673523, -0.9987954497337341},
  {-0.0980171412229538, -0.9951847195625305},
  {-0.1467304676771164, -0.9891765117645264},
  {-0.1950903236865997, -0.9807852506637573},
  {-0.2429801821708679, -0.9700312614440918},
  {-0.2902846634387970, -0.9569403529167175},
  {-0.3368898630142212, -0.9415440559387207},
  {-0.3826834261417389, -0.9238795042037964},
  {-0.4275550842285156, -0.9039893150329590},
  {-0.4713967442512512, -0.8819212913513184},
  {-0.5141027569770813, -0.8577286005020142},
  {-0.5555702447891235, -0.8314695954322815},
  {-0.5956993103027344, -0.8032075166702271},
  {-0.6343932747840881, -0.7730104327201843},
  {-0.6715589761734009, -0.7409511208534241},
  {-0.7071067690849304, -0.7071067690849304},
  {-0.7409511208534241, -0.6715589761734009},
  {-0.7730104327201843, -0.6343932747840881},
  {-0.8032075166702271, -0.5956993103027344},
  {-0.8314695954322815, -0.5555702447891235},
  {-0.8577286005020142, -0.5141027569770813},
  {-0.8819212913513184, -0.4713967442512512},
  {-0.9039893150329590, -0.4275550842285156},
  {-0.9238795042037964, -0.3826834261417389},
  {-0.9415440559387207, -0.3368898630142212},
  {-0.9569403529167175, -0.2902846634387970},
  {-0.9700312614440918, -0.2429801821708679},
  {-0.9807852506637573, -0.1950903236865997},
  {-0.9891765117645264, -0.1467304676771164},
  {-0.9951847195625305, -0.0980171412229538},
  {-0.9987954497337341, -0.0490676760673523}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7FD9, 0xF9B8},
   {0x7F62, 0xF374},
   {0x7E9D, 0xED38},
   {0x7D8A, 0xE707},
   {0x7C2A, 0xE0E6},
   {0x7A7D, 0xDAD8},
   {0x7885, 0xD4E1},
   {0x7642, 0xCF04},
   {0x73B6, 0xC946},
   {0x70E3, 0xC3A9},
   {0x6DCA, 0xBE32},
   {0x6A6E, 0xB8E3},
   {0x66D0, 0xB3C0},
   {0x62F2, 0xAECC},
   {0x5ED7, 0xAA0A},
   {0x5A82, 0xA57E},
   {0x55F6, 0xA129},
   {0x5134, 0x9D0E},
   {0x4C40, 0x9930},
   {0x471D, 0x9592},
   {0x41CE, 0x9236},
   {0x3C57, 0x8F1D},
   {0x36BA, 0x8C4A},
   {0x30FC, 0x89BE},
   {0x2B1F, 0x877B},
   {0x2528, 0x8583},
   {0x1F1A, 0x83D6},
   {0x18F9, 0x8276},
   {0x12C8, 0x8163},
   {0x0C8C, 0x809E},
   {0x0648, 0x8027},
   {0x0000, 0x8000},
   {0xF9B8, 0x8027},
   {0xF374, 0x809E},
   {0xED38, 0x8163},
   {0xE707, 0x8276},
   {0xE0E6, 0x83D6},
   {0xDAD8, 0x8583},
   {0xD4E1, 0x877B},
   {0xCF04, 0x89BE},
   {0xC946, 0x8C4A},
   {0xC3A9, 0x8F1D},
   {0xBE32, 0x9236},
   {0xB8E3, 0x9592},
   {0xB3C0, 0x9930},
   {0xAECC, 0x9D0E},
   {0xAA0A, 0xA129},
   {0xA57E, 0xA57E},
   {0xA129, 0xAA0A},
   {0x9D0E, 0xAECC},
   {0x9930, 0xB3C0},
   {0x9592, 0xB8E3},
   {0x9236, 0xBE32},
   {0x8F1D, 0xC3A9},
   {0x8C4A, 0xC946},
   {0x89BE, 0xCF04},
   {0x877B, 0xD4E1},
   {0x8583, 0xDAD8},
   {0x83D6, 0xE0E6},
   {0x8276, 0xE707},
   {0x8163, 0xED38},
   {0x809E, 0xF374},
   {0x8027, 0xF9B8}
#endif	/* ] */
#elif LOG2N==6				/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
  { 1.000000000000000, -0.000000000000000},
  { 0.995184719562531, -0.098017141222954},
  { 0.980785250663757, -0.195090323686600},
  { 0.956940352916718, -0.290284663438797},
  { 0.923879504203796, -0.382683426141739},
  { 0.881921291351318, -0.471396744251251},
  { 0.831469595432281, -0.555570244789124},
  { 0.773010432720184, -0.634393274784088},
  { 0.707106769084930, -0.707106769084930},
  { 0.634393274784088, -0.773010432720184},
  { 0.555570244789124, -0.831469595432281},
  { 0.471396744251251, -0.881921291351318},
  { 0.382683426141739, -0.923879504203796},
  { 0.290284663438797, -0.956940352916718},
  { 0.195090323686600, -0.980785250663757},
  { 0.098017141222954, -0.995184719562531},
  { 0.000000000000000, -1.000000000000000},
  {-0.098017141222954, -0.995184719562531},
  {-0.195090323686600, -0.980785250663757},
  {-0.290284663438797, -0.956940352916718},
  {-0.382683426141739, -0.923879504203796},
  {-0.471396744251251, -0.881921291351318},
  {-0.555570244789124, -0.831469595432281},
  {-0.634393274784088, -0.773010432720184},
  {-0.707106769084930, -0.707106769084930},
  {-0.773010432720184, -0.634393274784088},
  {-0.831469595432281, -0.555570244789124},
  {-0.881921291351318, -0.471396744251251},
  {-0.923879504203796, -0.382683426141739},
  {-0.956940352916718, -0.290284663438797},
  {-0.980785250663757, -0.195090323686600},
  {-0.995184719562531, -0.098017141222954}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7F62, 0xF374},
   {0x7D8A, 0xE707},
   {0x7A7D, 0xDAD8},
   {0x7642, 0xCF04},
   {0x70E3, 0xC3A9},
   {0x6A6E, 0xB8E3},
   {0x62F2, 0xAECC},
   {0x5A82, 0xA57E},
   {0x5134, 0x9D0E},
   {0x471D, 0x9592},
   {0x3C57, 0x8F1D},
   {0x30FC, 0x89BE},
   {0x2528, 0x8583},
   {0x18F9, 0x8276},
   {0x0C8C, 0x809E},
   {0x0000, 0x8000},
   {0xF374, 0x809E},
   {0xE707, 0x8276},
   {0xDAD8, 0x8583},
   {0xCF04, 0x89BE},
   {0xC3A9, 0x8F1D},
   {0xB8E3, 0x9592},
   {0xAECC, 0x9D0E},
   {0xA57E, 0xA57E},
   {0x9D0E, 0xAECC},
   {0x9592, 0xB8E3},
   {0x8F1D, 0xC3A9},
   {0x89BE, 0xCF04},
   {0x8583, 0xDAD8},
   {0x8276, 0xE707},
   {0x809E, 0xF374}
#endif	/* ] */
#elif LOG2N==5				/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
  { 1.000000000000000, -0.000000000000000},
  { 0.980785250663757, -0.195090323686600},
  { 0.923879504203796, -0.382683426141739},
  { 0.831469595432281, -0.555570244789124},
  { 0.707106769084930, -0.707106769084930},
  { 0.555570244789124, -0.831469595432281},
  { 0.382683426141739, -0.923879504203796},
  { 0.195090323686600, -0.980785250663757},
  { 0.000000000000000, -1.000000000000000},
  {-0.195090323686600, -0.980785250663757},
  {-0.382683426141739, -0.923879504203796},
  {-0.555570244789124, -0.831469595432281},
  {-0.707106769084930, -0.707106769084930},
  {-0.831469595432281, -0.555570244789124},
  {-0.923879504203796, -0.382683426141739},
  {-0.980785250663757, -0.195090323686600}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7D8A, 0xE707},
   {0x7642, 0xCF04},
   {0x6A6E, 0xB8E3},
   {0x5A82, 0xA57E},
   {0x471D, 0x9592},
   {0x30FC, 0x89BE},
   {0x18F9, 0x8276},
   {0x0000, 0x8000},
   {0xE707, 0x8276},
   {0xCF04, 0x89BE},
   {0xB8E3, 0x9592},
   {0xA57E, 0xA57E},
   {0x9592, 0xB8E3},
   {0x89BE, 0xCF04},
   {0x8276, 0xE707}
#endif	/* ] */
#elif LOG2N==4				/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
  { 1.00000000000000,  0.00000000000000},
  { 0.92387953251129, -0.38268343236509},
  { 0.70710678118655, -0.70710678118655},
  { 0.38268343236509, -0.92387953251129},
  { 0.00000000000000, -1.00000000000000},
  {-0.38268343236509, -0.92387953251129},
  {-0.70710678118655, -0.70710678118655},
  {-0.92387953251129, -0.38268343236509}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7642, 0xCF04},
   {0x5A82, 0xA57E},
   {0x30FC, 0x89BE},
   {0x0000, 0x8000},
   {0xCF04, 0x89BE},
   {0xA57E, 0xA57E},
   {0x89BE, 0xCF04}
#endif	/* ] */
#elif LOG2N==3				/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
   { 1.00000000000000000000,  0.00000000000000000000},
   { 0.70710676908493041992, -0.70710676908493041992},
   { 0.00000000000000015702, -1.00000000000000000000},
   {-0.70710676908493041992, -0.70710676908493041992}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x5A82, 0xA57E},
   {0x0000, 0x8000},
   {0xA57E, 0xA57E}
#endif	/* ] */
#else	/* ][ */
#if	DATA_TYPE==FLOATING		/* [ */
   { 1.00000000000000000000,  0.00000000000000000000},
   { 0.00000000000000015702, -1.00000000000000000000}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x0000, 0x8000}
#endif	/* ] */
#endif	/* ] */
};

fractcomplex CosineFactors[NUM_FACTS] ModBuf_X(NUM_FACTS*2) = {
#if	DATA_TYPE==FLOATING		/* [ */
   {1.00000000000000, 0.00000000000000},
   {0.99518472667220, 0.09801714032956},
   {0.98078528040323, 0.19509032201613},
   {0.95694033573221, 0.29028467725446},
   {0.92387953251129, 0.38268343236509},
   {0.88192126434836, 0.47139673682600},
   {0.83146961230255, 0.55557023301960},
   {0.77301045336274, 0.63439328416365}
#else	/* ][ */
   {0x7FFF, 0x0000},
   {0x7F62, 0x0C8C},
   {0x7D8A, 0x18F9},
   {0x7A7D, 0x2528},
   {0x7642, 0x30FC},
   {0x70E3, 0x3C57},
   {0x6A6E, 0x471D},
   {0x62F2, 0x5134}
#endif	/* ] */
};


/* Local function prototypes. */

/*...........................................................................*/

/* MAIN PROGRAM */
int main ( 
	int argc,
	char** argv
) {

   /* Local declarations. */
   fractional* window = theWindow;
   fractional* srcVectorOne = VectorOne;
   fractional* srcVectorTwo = VectorTwo;
   fractional* dstVector = \
   	(fractional*) malloc ((int) (2*NUM_ELEMS)*sizeof(fractional));
					/* not needed for in-place ops */
					/* but it is OK to use it, anyway */
   fractcomplex* srcCVector = \
   	(fractcomplex*) malloc ((int) (2*NUM_FACTS)*sizeof(fractcomplex));
   fractional* srcSamps = \
   	(fractional*) malloc ((int) (NUM_SAMPS)*sizeof(fractional));
   fractional* dstSamps = \
   	(fractional*) malloc ((int) (NUM_SAMPS*RATE)*sizeof(fractional));
   fractional* srcMatrixOne = MatrixOne;
   fractional* srcMatrixTwo = MatrixTwo;
   float* srcMatrixThree = MatrixThree;
   float* pivotFlag = (float*) malloc (NUM_ROWSF*sizeof(float));
   int* swappedRows = (int*) malloc (NUM_ROWSF*sizeof(int));
   int* swappedCols = (int*) malloc (NUM_ROWSF*sizeof(int));
   fractional* dstMatrix = \
   	(fractional*) malloc ((int) NUM_ROWS*NUM_COLS*sizeof(fractional));
					/* not needed for in-place ops */
					/* but it is OK to use it, anyway */
   int coeffsPage = (int) COEFFS_IN_DATA;
   int lattsPage = (int) COEFFS_IN_DATA;
   int factsPage = (int) COEFFS_IN_DATA;
   fractional* firCoeffs = FIRCoeffs;
   fractional* lattKappas = LattKappas;
   fractcomplex* twidFactors = TwidFactors;
   fractcomplex* cosineFactors = CosineFactors;
   fractional value = (fractional) SCL_VALUE;
   fractional zeroVal = 0;
   IIRCanonicStruct* iirCanonic = \
      (IIRCanonicStruct*) malloc (sizeof(IIRCanonicStruct));
   IIRTransposedStruct* iirTransposed = \
      (IIRTransposedStruct*) malloc (sizeof(IIRTransposedStruct));
   IIRLatticeStruct* filterLattice = \
      (IIRLatticeStruct*) malloc (sizeof(IIRLatticeStruct));
   FIRStruct* FIRFilter = \
      (FIRStruct*) malloc (sizeof(FIRStruct));
   FIRStruct* FIRLatticeFilter = \
      (FIRStruct*) malloc (sizeof(FIRStruct));
   int index = 0;
   int numElems = 0;
   int numRows = 0;
   int numCols = 0;
   int row = 0;
   int col = 0;
   int cntr = 0;
   fractional* buffer = NULL;
   fractcomplex* bufferC = NULL;
   float* bufferF = NULL;

#ifdef	IN_SPACE			/* [ */
#if	IN_SPACE==IN_P_SPACE		/* [ program memory space */
   asm ("mov #psvpage(%1),%0" : "=r"(coeffsPage) : "g"(FIRCoeffs));
   asm ("mov #psvpage(%1),%0" : "=r"(lattsPage) : "g"(LattKappas));
   asm ("mov #psvpage(%1),%0" : "=r"(factsPage) : "g"(TwidFactors));
   asm ("mov #psvoffset(%1),%0" : "=r"(firCoeffs) : "g"(FIRCoeffs));
   asm ("mov #psvoffset(%1),%0" : "=r"(twidFactors) : "g"(TwidFactors));
   asm ("mov #psvoffset(%1),%0" : "=r"(lattsKappas) : "g"(LattKappas));
#endif	/* ] */
#endif	/* ] */

   /* Initialize filter structure. */
   iirCanonic->numSectionsLess1 = NUM_SECTS-1;
   iirCanonic->coeffsBase = IIRCanonicCoeffs;
   iirCanonic->delayBase = FIRDelay;			/* reuse */
   iirCanonic->coeffsPage = (int) COEFFS_IN_DATA;
   iirCanonic->initialGain = Float2Fract (0.184387207031250);
   iirCanonic->finalShift = 0;

   /* Initialize filter structure. */
   iirTransposed->numSectionsLess1 = NUM_SECTS-1;
   iirTransposed->coeffsBase = IIRTransposedCoeffs;
   iirTransposed->delayBase1 = FIRDelay;			/* reuse */
   iirTransposed->delayBase2 = VectorTwo;			/* reuse */
   iirTransposed->coeffsPage = (int) COEFFS_IN_DATA;
   iirTransposed->finalShift = 0;

   /* Structure initialization. */
   filterLattice->order = LATT_ORDER;
   filterLattice->kappaVals = LattKappas;
   filterLattice->delay = LattDelay;
   filterLattice->gammaVals = LattGammas;
   FIRStructInit (FIRFilter, (int) NUM_TAPS, firCoeffs, coeffsPage, FIRDelay);
   FIRStructInit (FIRLatticeFilter, (int) LATT_ORDER, lattKappas, lattsPage, LattDelay);

   /* Source vector initialization. */
   if (2*NUM_FACTS <= NUM_ELEMS) {
      for (cntr = 0; cntr < 2*NUM_FACTS; cntr++) {
         srcCVector[cntr].real = VectorOne[cntr];	/* real part */
         srcCVector[cntr].imag = VectorTwo[cntr];	/* imag part */
      }
   } else {
      for (cntr = 0; cntr < NUM_FACTS/2; cntr++) {
#if	DATA_TYPE==FLOATING		/* [ */
         srcCVector[4*cntr].real = SrcSamps[cntr]/2.0;
         srcCVector[4*cntr].imag = SrcSamps[NUM_FACTS-cntr]/2.0;
         srcCVector[4*cntr+1].real = SrcSamps[cntr]/2.0;
         srcCVector[4*cntr+1].imag = SrcSamps[NUM_FACTS-cntr]/2.0;
         srcCVector[4*cntr+2].real = SrcSamps[cntr]/2.0;
         srcCVector[4*cntr+2].imag = SrcSamps[NUM_FACTS-cntr]/2.0;
         srcCVector[4*cntr+3].real = SrcSamps[cntr]/2.0;
         srcCVector[4*cntr+3].imag = SrcSamps[NUM_FACTS-cntr]/2.0;
#else	/* ][ */
         srcCVector[4*cntr].real = SrcSamps[cntr]>>1;
         srcCVector[4*cntr].imag = SrcSamps[NUM_FACTS-cntr]>>1;
         srcCVector[4*cntr+1].real = SrcSamps[cntr]>>1;
         srcCVector[4*cntr+1].imag = SrcSamps[NUM_FACTS-cntr]>>1;
         srcCVector[4*cntr+2].real = SrcSamps[cntr]>>1;
         srcCVector[4*cntr+2].imag = SrcSamps[NUM_FACTS-cntr]>>1;
         srcCVector[4*cntr+3].real = SrcSamps[cntr]>>1;
         srcCVector[4*cntr+3].imag = SrcSamps[NUM_FACTS-cntr]>>1;
#endif	/* ] */
      }
   }

   /* Apply the vector operations. */
   /*
   value = VectorMax ((int) NUM_ELEMS, srcVectorOne, &index);
   value = VectorMin ((int) NUM_ELEMS, srcVectorOne, &index);
   dstVector = VectorNegate ((int) NUM_ELEMS, dstVector, srcVectorOne);
   dstVector = VectorScale ((int) NUM_ELEMS, dstVector, srcVectorOne, value);
   dstVector = VectorAdd ((int) NUM_ELEMS, dstVector, srcVectorOne, srcVectorTwo);
   dstVector = VectorSubtract ((int) NUM_ELEMS, dstVector, srcVectorOne, srcVectorTwo);
   dstVector = VectorMultiply ((int) NUM_ELEMS, dstVector, srcVectorOne, srcVectorTwo);
   value = VectorDotProduct ((int) NUM_ELEMS, srcVectorOne, srcVectorTwo);
   value = VectorPower ((int) NUM_ELEMS, srcVectorTwo);
   dstVector = VectorConvolve ((int) NUM_ELEMS, (int) NUM_ELEMS-7, dstVector, srcVectorOne, srcVectorTwo);
   dstVector = VectorConvolve ((int) NUM_ELEMS, (int) NUM_ELEMS, dstVector, srcVectorOne, srcVectorOne);
   dstVector = VectorCorrelate ((int) NUM_ELEMS, (int) NUM_ELEMS-7, dstVector, srcVectorOne, srcVectorTwo);
   */

   /* Apply the window operations. */
   /*
   window = BartlettInit ((int) NUM_ELEMS, theWindow);
   window = BlackmanInit ((int) NUM_ELEMS, theWindow);
   window = HammingInit ((int) NUM_ELEMS, theWindow);
   window = HanningInit ((int) NUM_ELEMS, theWindow);
   dstVector = KaiserInit ((int) NUM_ELEMS, theWindow, (double) 0.707);
   dstVector = VectorWindow ((int) NUM_ELEMS, dstVector, srcVectorOne, window);
   */

   /* Apply the matrix operations. */
   /*
   dstMatrix = MatrixScale ((int) NUM_ROWS, (int) NUM_COLS, dstMatrix, srcMatrixOne, value);
   dstMatrix = MatrixTranspose ((int) NUM_ROWS, (int) NUM_COLS, dstMatrix, srcMatrixOne);
   dstMatrix = MatrixAdd ((int) NUM_ROWS, (int) NUM_COLS, dstMatrix, srcMatrixOne, srcMatrixTwo);
   dstMatrix = MatrixSubtract ((int) NUM_ROWS, (int) NUM_COLS, dstMatrix, srcMatrixOne, srcMatrixTwo);
   dstMatrix = MatrixMultiply ((int) NUM_ROWS, (int) NUM_COLS, (int) NUM_ROWS, dstMatrix, srcMatrixOne, srcMatrixTwo);
   srcMatrixThree = MatrixInvert ((int) NUM_ROWSF, srcMatrixThree, srcMatrixThree, pivotFlag, swappedRows, swappedCols);
   */

   /* Apply the filtering operations. */
   /*
   FIRDelayInit (FIRFilter);
   dstSamps = FIR ((int) NUM_SAMPS, dstSamps, SrcSamps, FIRFilter);
   FIRDelayInit (FIRFilter);
   dstSamps = FIRDecimate ((int) NUM_SAMPS/RATE, dstSamps, SrcSamps, FIRFilter, (int) RATE);
   FIRInterpDelayInit (FIRFilter, (int) RATE);
   dstSamps = FIRInterpolate ((int) NUM_SAMPS, dstSamps, SrcSamps, FIRFilter, (int) RATE);
   FIRDelayInit (FIRFilter);
   dstSamps = FIRLMS ((int) NUM_SAMPS, dstSamps, SrcSamps, FIRFilter, SrcSamps, Float2Fract(0.1));
   FIRDelayInit (FIRFilter);
   srcSamps = VectorScale ((int) NUM_SAMPS, srcSamps, SrcSamps, Float2Fract (SQRT_2_OVER_NUM_TAPS));
   dstSamps = FIRLMSNorm ((int) NUM_SAMPS, dstSamps, srcSamps, FIRFilter, srcSamps, Float2Fract(0.1), &zeroVal);
   FIRDelayInit (FIRLatticeFilter);
   dstSamps = FIRLattice ((int) NUM_SAMPS, dstSamps, SrcSamps, FIRLatticeFilter);
   IIRLatticeInit ((IIRLatticeStruct*) filterLattice);
   dstSamps = IIRLattice ((int) NUM_SAMPS, dstSamps, SrcSamps, (IIRLatticeStruct*) filterLattice);
   IIRCanonicInit (iirCanonic);
   dstSamps = IIRCanonic ((int) NUM_SAMPS, dstSamps, srcSamps, iirCanonic);
   */
   srcSamps[0] = Float2Fract (1.0);
   for (cntr = 1; cntr < NUM_SAMPS; cntr++) {
      srcSamps[cntr] = 0;
   }
   IIRTransposedInit (iirTransposed);
   dstSamps = IIRTransposed ((int) NUM_SAMPS, dstSamps, srcSamps, iirTransposed);


   /* Apply the transform operations. */
   /*
   dstVector = (fractional*) FFTComplexIP (LOG2N, srcCVector, twidFactors, factsPage);
   twidFactors = TwidFactorInit (LOG2N, twidFactors, 0);
   dstVector = (fractional*) BitReverseComplex (LOG2N, srcCVector);
   dstVector = (fractional*) FFTComplex (LOG2N, (fractcomplex*) dstVector, srcCVector, twidFactors, factsPage);
   twidFactors = TwidFactorInit (LOG2N, twidFactors, 1);
   dstVector = (fractional*) IFFTComplex (LOG2N, (fractcomplex*) dstVector, srcCVector, twidFactors, factsPage);
   dstVector = (fractional*) IFFTComplexIP (LOG2N, srcCVector, twidFactors, factsPage);
   cosineFactors = CosFactorInit (LOG2N, cosineFactors);
   dstVector = VectorZeroPad (1<<LOG2N, 1<<LOG2N, dstVector, (fractional*) srcCVector);
   dstVector = DCTIP (LOG2N, dstVector, cosineFactors, twidFactors, factsPage);
   twidFactors = TwidFactorInit (LOG2N, twidFactors, 1);
   dstVector = DCT (LOG2N, dstVector, (fractional*) srcCVector, cosineFactors, twidFactors, factsPage);
   */

   /* Report values after. */
   buffer = dstSamps;
   bufferC = NULL;
   bufferF = NULL;
   numElems = NUM_SAMPS;
   numRows = 0;
   numCols = 0;

   /* Do NOT use "printf" for MPLAB debugging... */
   /*
   printf ("%2.20f\n", Fract2Float (value));
   printf ("%d\n", index);
   */
   if (numElems != 0) {
   for (cntr = 0; cntr < numElems; cntr++) {
      if (bufferC == NULL) {
         printf ("%2.20f\n", Fract2Float (buffer[cntr]));
      } else {
         printf ("%2.20f\n", Fract2Float (bufferC[cntr].real));
         printf ("%2.20f\n", Fract2Float (bufferC[cntr].imag));
      }
   }
   } else {
   for (row = 0; row < numRows; row++) {
      for (col = 0; col < numCols; col++) {
	 if (bufferF == NULL) {
	    printf ("%2.20f\n", Fract2Float (buffer[row*numCols+col]));
	 } else {
            printf (" %2.20f\n", (float) bufferF[row*numCols+col]);
	 }
      }
   }
   }

   /* Clean up. */
   /* Forget it... Segmentation fault if I used in-place operations...
   */

   return (0);

}

/*...........................................................................*/

/* Local function implementations. */

/***************************************************************************/
/* EOF */
